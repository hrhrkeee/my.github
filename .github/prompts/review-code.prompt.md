<!-- ============================================================
  .github/prompts/review-code.prompt.md
  ============================================================
  【このファイルの役割】
  再利用可能な「プロンプトファイル」（スラッシュコマンド）。
  チャットで `/review-code` と入力すると、このプロンプトが実行される。
  コードレビューや特定タスクのワークフローをワンショットで実行するためのテンプレート。

  【何を記載するか】
  - タスクの具体的な指示
  - 期待する出力形式
  - チェックすべき観点
  - 参照すべきファイルやリソース（Markdownリンク）

  【AIへの影響】
  - ユーザーが `/review-code` で呼び出した時にのみ実行される（常時適用ではない）
  - カスタムインストラクションと組み合わせて使用可能

  【ヘッダー（フロントマター）の設定項目】
  - description: プロンプトの説明
  - agent: 使用するエージェント（ask, edit, agent, カスタムエージェント名）
  - model: 使用する言語モデル（省略時はモデルピッカーの選択）
  - tools: 使用可能なツールのリスト

  【配置場所】
  - .github/prompts/ ディレクトリ配下に *.prompt.md として配置

  【変数の使用】
  - ${selection} - 現在選択中のテキスト
  - ${file} - 現在のファイルパス
  - ${input:変数名} - ユーザーからの入力
  ============================================================ -->
---
description: "選択したPython/MLコードをレビューし、品質・パフォーマンス・再現性を確認する"
agent: "ask"
---

# MLコードレビュー

以下のコードをレビューしてください。

## レビュー対象

${selection}

## レビュー観点

以下の観点でレビューを行い、問題があれば指摘してください:

### 1. 再現性
- ランダムシードが固定されているか
- データの分割方法は適切か
- 実験条件が記録・再現可能な状態か

### 2. パフォーマンス
- 不要なテンソルがGPUメモリに残っていないか（detach/del/torch.no_grad）
- DataLoaderの設定（num_workers, pin_memory）は適切か
- 不必要な計算グラフの保持がないか

### 3. コード品質
- 型ヒントが付与されているか
- 関数の責務は単一か
- 命名は適切で分かりやすいか（英語、snake_case/PascalCase）
- コメントは日本語で記載されているか

### 4. エラーハンドリング
- チェックポイントの保存時に例外処理があるか
- GPU/CPU切り替え時のデバイス指定は適切か
- ファイルI/Oのエラーが処理されているか

### 5. プロジェクト規約
- 出力が output/YYYYMMDD-hhmmss_[task名]/ に書き出されているか
- uv add で管理されていないパッケージを使っていないか

## 出力形式

各観点について以下の形式で回答してください:
- 問題なし: 良い点の説明
- 警告: 改善を推奨する内容と修正案
- 問題あり: 修正が必要な内容と修正コード
